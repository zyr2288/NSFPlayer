!function(e){var t={};function s(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(i,r,function(t){return e[t]}.bind(null,r));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=1)}([function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CPU_NTSC=29780.5,t.CPU_PAL=33247.5,t.CPU_Dendy=35464,t.FrameCountLength=[10,254,20,2,40,4,80,6,160,8,60,10,14,12,26,14,12,16,24,18,48,20,96,22,192,24,72,26,16,28,32,30],t.APU_COUNT_STEP=[7457,14913,22371,29829,37281]},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(2);window.NSFPlayer=function(){return new i.default}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(3),r=s(4),a=s(14),n=s(0),o=function(){function e(){var e=this;this.allCycle=0,this.tempCycle=0,this.audioContext=new AudioContext,this.bufferLength=512,this.sampleLength=4096,this.sampleMask=4095,this.bufferReady=!1,this.audioSamples=new Float32Array(this.sampleLength),this.audioWriteIndex=0,this.audioReadIndex=0,this.play=!1,this.nowPlaying=0,this.nsfFile=new a.default(this),this.cpu=new i.default(this),this.apu=new r.default(this);var t=this.audioContext.createScriptProcessor(this.bufferLength,1,1);t.onaudioprocess=function(t){var s=t.outputBuffer.getChannelData(0),i=t.outputBuffer.length,r=0;if(e.play)if((e.audioWriteIndex-e.audioReadIndex&e.sampleMask)<e.bufferLength&&e.OneFrame(),e.bufferReady){for(a=0;a<i;a++)r=e.audioReadIndex+a&e.sampleMask,s[a]=e.audioSamples[r];e.audioReadIndex=e.audioReadIndex+i&e.sampleMask}else e.audioWriteIndex>i&&(e.bufferReady=!0);else for(var a=0;a<i;a++)s[a]=0},t.connect(this.audioContext.destination)}return e.prototype.Reset=function(){this.cpu.Reset(),this.apu.Reset(),this.audioReadIndex=this.audioWriteIndex=0,this.bufferReady=!1},e.prototype.OneFrame=function(){for(;;){for(this.tempCycle=this.cpu.OneOperation(),this.apu.sampleTime+=this.tempCycle,this.allCycle+=this.tempCycle,this.apu.DoClock(this.tempCycle);this.apu.sampleTime>=this.apu.SAMPLE_CPU_CLOCKS;)this.apu.sampleTime-=this.apu.SAMPLE_CPU_CLOCKS,this.SetBuffer(this.apu.mixer.GetSample());if(this.allCycle>=n.CPU_NTSC){this.allCycle-=n.CPU_NTSC;break}}this.cpu.doNothingMode=!1,2==this.cpu.interruptType&&(this.cpu.register_PC=14336)},e.prototype.Play=function(e){isNaN(e)||(this.Reset(),this.cpu.memory[14336]=32,this.cpu.memory[14337]=255&this.nsfFile.playAddress,this.cpu.memory[14338]=this.nsfFile.playAddress>>8,this.cpu.memory[14339]=32,this.cpu.memory[14340]=255&this.nsfFile.initAddress,this.cpu.memory[14341]=this.nsfFile.initAddress>>8,this.cpu.nmiAddress=14336,e<1&&(e=1),e>this.nsfFile.songsCount&&(e=this.nsfFile.songsCount),this.nowPlaying=e,e--,this.cpu.register_A=e,this.cpu.register_PC=14339,this.play=!0,this.audioContext.resume())},e.prototype.Next=function(){this.Play(++this.nowPlaying)},e.prototype.Preview=function(){this.Play(--this.nowPlaying)},e.prototype.GetSongName=function(){return this.nsfFile.name},e.prototype.GetSongArtist=function(){return this.nsfFile.artist},e.prototype.GetSongCopyright=function(){return this.nsfFile.copyright},e.prototype.SetBuffer=function(e){this.audioSamples[this.audioWriteIndex]=e,this.audioWriteIndex++,this.audioWriteIndex&=this.sampleMask},e}();t.default=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.memory=new Uint8Array(32768),this.register_A=0,this.register_X=0,this.register_Y=0,this.register_PC=0,this.register_S=0,this.register_P=0,this.flags=new Array(8),this.clock=0,this.usingSRAM=!1,this.irqAddress=0,this.nmiAddress=0,this.interruptType=0,this.doNothingMode=!1,this.operations=[],this.nsf=e,this.Reset()}return e.prototype.Reset=function(){this.ResetMemory(),this.flags[7]=!1,this.flags[6]=!1,this.flags[5]=!0,this.flags[4]=!1,this.flags[3]=!1,this.flags[2]=!0,this.flags[1]=!1,this.flags[0]=!1,this.register_P=36,this.interruptType=0,this.clock=0,this.register_A=this.register_X=this.register_Y=0,this.register_S=255;for(var e=0;e<256;e++)this.operations[e]=this.SetOperation(e)},e.prototype.DoOperation=function(e){var t=0;switch(e){case 168:this.register_Y=this.OperationToRegister(this.register_A);break;case 170:this.register_X=this.OperationToRegister(this.register_A);break;case 186:this.register_X=this.OperationToRegister(this.register_X);break;case 152:this.register_A=this.OperationToRegister(this.register_Y);break;case 138:this.register_A=this.OperationToRegister(this.register_X);break;case 154:this.register_S=this.register_X,this.clock=2,this.register_PC++;break;case 169:t=this.FindAddress(1),this.register_A=this.OperationLD(t,2);break;case 165:t=this.FindAddress(2),this.register_A=this.OperationLD(t,3);break;case 181:t=this.FindAddress(3),this.register_A=this.OperationLD(t+this.register_X&255,4);break;case 173:t=this.FindAddress(5),this.register_A=this.OperationLD(t,4);break;case 189:t=this.FindAddress(6),this.register_A=this.OperationLD(t+this.register_X,4,(255&t)+this.register_X>255);break;case 185:t=this.FindAddress(7),this.register_A=this.OperationLD(t+this.register_Y,4,(255&t)+this.register_Y>255);break;case 161:t=this.FindAddress(9),this.register_A=this.OperationLD(t,6);break;case 177:t=this.FindAddress(10),this.register_A=this.OperationLD(t+this.register_Y,5,(255&t)+this.register_Y>255);break;case 162:t=this.FindAddress(1),this.register_X=this.OperationLD(t,2);break;case 166:t=this.FindAddress(2),this.register_X=this.OperationLD(t,3);break;case 182:t=this.FindAddress(4),this.register_X=this.OperationLD(t+this.register_Y&255,4);break;case 174:t=this.FindAddress(5),this.register_X=this.OperationLD(t,4);break;case 190:t=this.FindAddress(7),this.register_X=this.OperationLD(t+this.register_Y,4,(255&t)+this.register_Y>255);break;case 160:t=this.FindAddress(1),this.register_Y=this.OperationLD(t,2);break;case 164:t=this.FindAddress(2),this.register_Y=this.OperationLD(t,3);break;case 180:t=this.FindAddress(3),this.register_Y=this.OperationLD(t+this.register_X&255,4);break;case 172:t=this.FindAddress(5),this.register_Y=this.OperationLD(t,4);break;case 188:t=this.FindAddress(6),this.register_Y=this.OperationLD(t+this.register_X,4,(255&t)+this.register_X>255);break;case 133:t=this.FindAddress(2),this.OperationST(t,3,this.register_A);break;case 149:t=this.FindAddress(3),this.OperationST(t+this.register_X&255,4,this.register_A);break;case 141:t=this.FindAddress(5),this.OperationST(t,4,this.register_A);break;case 157:t=this.FindAddress(6),this.OperationST(t+this.register_X,5,this.register_A);break;case 153:t=this.FindAddress(7),this.OperationST(t+this.register_Y,5,this.register_A);break;case 129:t=this.FindAddress(9),this.OperationST(t,6,this.register_A);break;case 145:t=this.FindAddress(10),this.OperationST(t+this.register_Y,6,this.register_A);break;case 134:t=this.FindAddress(2),this.OperationST(t,3,this.register_X);break;case 150:t=this.FindAddress(4),this.OperationST(t+this.register_Y&255,4,this.register_X);break;case 142:t=this.FindAddress(5),this.OperationST(t,4,this.register_X);break;case 132:t=this.FindAddress(2),this.OperationST(t,3,this.register_Y);break;case 148:t=this.FindAddress(3),this.OperationST(t+this.register_X&255,4,this.register_Y);break;case 140:t=this.FindAddress(5),this.OperationST(t,4,this.register_Y);break;case 72:this.OperationP(0);break;case 8:this.OperationP(1);break;case 104:this.OperationP(2);break;case 40:this.OperationP(3);break;case 105:t=this.FindAddress(1),this.OperationADCOrSBC(t,2,4);break;case 101:t=this.FindAddress(2),this.OperationADCOrSBC(t,3,4);break;case 117:t=this.FindAddress(3),this.OperationADCOrSBC(t+this.register_X&255,4,4);break;case 109:t=this.FindAddress(5),this.OperationADCOrSBC(t,4,4);break;case 125:t=this.FindAddress(6),this.OperationADCOrSBC(t+this.register_X,4,4,(255&t)+this.register_X>255);break;case 121:t=this.FindAddress(7),this.OperationADCOrSBC(t+this.register_Y,4,4,(255&t)+this.register_Y>255);break;case 97:t=this.FindAddress(9),this.OperationADCOrSBC(t,6,4);break;case 113:t=this.FindAddress(10),this.OperationADCOrSBC(t+this.register_Y,5,4,(255&t)+this.register_Y>255);break;case 233:t=this.FindAddress(1),this.OperationADCOrSBC(t,2,5);break;case 229:t=this.FindAddress(2),this.OperationADCOrSBC(t,3,5);break;case 245:t=this.FindAddress(3),this.OperationADCOrSBC(t+this.register_X,4,5);break;case 237:t=this.FindAddress(5),this.OperationADCOrSBC(t,4,5);break;case 253:t=this.FindAddress(6),this.OperationADCOrSBC(t+this.register_X,4,5,(255&t)+this.register_X>255);break;case 249:t=this.FindAddress(7),this.OperationADCOrSBC(t+this.register_Y,4,5,(255&t)+this.register_Y>255);break;case 225:t=this.FindAddress(9),this.OperationADCOrSBC(t,6,5);break;case 241:t=this.FindAddress(10),this.OperationADCOrSBC(t+this.register_Y,5,5,(255&t)+this.register_Y>255);break;case 41:t=this.FindAddress(1),this.OperationANDOrEOROrORA(t,2,6);break;case 37:t=this.FindAddress(2),this.OperationANDOrEOROrORA(t,3,6);break;case 53:t=this.FindAddress(3),this.OperationANDOrEOROrORA(t+this.register_X,4,6);break;case 45:t=this.FindAddress(5),this.OperationANDOrEOROrORA(t,4,6);break;case 61:t=this.FindAddress(6),this.OperationANDOrEOROrORA(t+this.register_X,4,6,(255&t)+this.register_X>255);break;case 57:t=this.FindAddress(7),this.OperationANDOrEOROrORA(t+this.register_Y,4,6,(255&t)+this.register_Y>255);break;case 33:t=this.FindAddress(9),this.OperationANDOrEOROrORA(t,6,6);break;case 49:t=this.FindAddress(10),this.OperationANDOrEOROrORA(t+this.register_Y,5,6,(255&t)+this.register_Y>255);break;case 73:t=this.FindAddress(1),this.OperationANDOrEOROrORA(t,2,7);break;case 69:t=this.FindAddress(2),this.OperationANDOrEOROrORA(t,3,7);break;case 85:t=this.FindAddress(3),this.OperationANDOrEOROrORA(t+this.register_X,4,7);break;case 77:t=this.FindAddress(5),this.OperationANDOrEOROrORA(t,4,7);break;case 93:t=this.FindAddress(6),this.OperationANDOrEOROrORA(t+this.register_X,4,7,(255&t)+this.register_X>255);break;case 89:t=this.FindAddress(7),this.OperationANDOrEOROrORA(t+this.register_Y,4,7,(255&t)+this.register_Y>255);break;case 65:t=this.FindAddress(9),this.OperationANDOrEOROrORA(t,6,7);break;case 81:t=this.FindAddress(10),this.OperationANDOrEOROrORA(t+this.register_Y,5,7,(255&t)+this.register_Y>255);break;case 9:t=this.FindAddress(1),this.OperationANDOrEOROrORA(t,2,8);break;case 5:t=this.FindAddress(2),this.OperationANDOrEOROrORA(t,3,8);break;case 21:t=this.FindAddress(3),this.OperationANDOrEOROrORA(t+this.register_X,4,8);break;case 13:t=this.FindAddress(5),this.OperationANDOrEOROrORA(t,4,8);break;case 29:t=this.FindAddress(6),this.OperationANDOrEOROrORA(t+this.register_X,4,8,(255&t)+this.register_X>255);break;case 25:t=this.FindAddress(7),this.OperationANDOrEOROrORA(t+this.register_Y,4,8,(255&t)+this.register_Y>255);break;case 1:t=this.FindAddress(9),this.OperationANDOrEOROrORA(t,6,8);break;case 17:t=this.FindAddress(10),this.OperationANDOrEOROrORA(t+this.register_Y,5,8,(255&t)+this.register_Y>255);break;case 201:t=this.FindAddress(1),this.OperationCP(this.register_A,t,2);break;case 197:t=this.FindAddress(2),this.OperationCP(this.register_A,t,3);break;case 213:t=this.FindAddress(3),this.OperationCP(this.register_A,t+this.register_X&255,2);break;case 205:t=this.FindAddress(5),this.OperationCP(this.register_A,t,4);break;case 221:t=this.FindAddress(6),this.OperationCP(this.register_A,t+this.register_X,4,(255&t)+this.register_X>255);break;case 217:t=this.FindAddress(7),this.OperationCP(this.register_A,t+this.register_Y,4,(255&t)+this.register_Y>255);break;case 193:t=this.FindAddress(9),this.OperationCP(this.register_A,t,6);break;case 209:t=this.FindAddress(10),this.OperationCP(this.register_A,t+this.register_Y,5,(255&t)+this.register_Y>255);break;case 224:t=this.FindAddress(1),this.OperationCP(this.register_X,t,2);break;case 228:t=this.FindAddress(2),this.OperationCP(this.register_X,t,3);break;case 236:t=this.FindAddress(5),this.OperationCP(this.register_X,t,4);break;case 192:t=this.FindAddress(1),this.OperationCP(this.register_Y,t,2);break;case 196:t=this.FindAddress(2),this.OperationCP(this.register_Y,t,3);break;case 204:t=this.FindAddress(5),this.OperationCP(this.register_Y,t,4);break;case 36:t=this.FindAddress(2),this.OperationBIT(t,3);break;case 44:t=this.FindAddress(5),this.OperationBIT(t,4);break;case 230:t=this.FindAddress(2),this.OperationINCOrDec(5,1,t,9);break;case 246:t=this.FindAddress(3),this.OperationINCOrDec(6,1,t+this.register_X&255,9);break;case 238:t=this.FindAddress(5),this.OperationINCOrDec(6,1,t,9);break;case 254:t=this.FindAddress(6),this.OperationINCOrDec(7,1,t+this.register_X,9);break;case 232:this.register_X=this.OperationINCOrDec(2,1,this.register_X,10);break;case 200:this.register_Y=this.OperationINCOrDec(2,1,this.register_Y,10);break;case 198:t=this.FindAddress(2),this.OperationINCOrDec(5,-1,t,9);break;case 214:t=this.FindAddress(3),this.OperationINCOrDec(6,-1,t+this.register_X&255,9);break;case 206:t=this.FindAddress(5),this.OperationINCOrDec(6,-1,t,9);break;case 222:t=this.FindAddress(6),this.OperationINCOrDec(7,-1,t+this.register_X,9);break;case 202:this.register_X=this.OperationINCOrDec(2,-1,this.register_X,10);break;case 136:this.register_Y=this.OperationINCOrDec(2,-1,this.register_Y,10);break;case 10:this.OperationShift(2,!1,!0);break;case 6:t=this.FindAddress(2),this.OperationShift(5,!1,!0,t);break;case 22:t=this.FindAddress(3),this.OperationShift(6,!1,!0,t+this.register_X&255);break;case 14:t=this.FindAddress(5),this.OperationShift(6,!1,!0,t);break;case 30:t=this.FindAddress(6),this.OperationShift(7,!1,!0,t+this.register_X);break;case 74:this.OperationShift(2,!1,!1);break;case 70:t=this.FindAddress(2),this.OperationShift(5,!1,!1,t);break;case 86:t=this.FindAddress(3),this.OperationShift(6,!1,!1,t+this.register_X&255);break;case 78:t=this.FindAddress(5),this.OperationShift(6,!1,!1,t);break;case 94:t=this.FindAddress(6),this.OperationShift(7,!1,!1,t+this.register_X);break;case 42:this.OperationShift(2,!0,!0);break;case 38:t=this.FindAddress(2),this.OperationShift(5,!0,!0,t);break;case 54:t=this.FindAddress(3),this.OperationShift(6,!0,!0,t+this.register_X&255);break;case 46:t=this.FindAddress(5),this.OperationShift(6,!0,!0,t);break;case 62:t=this.FindAddress(6),this.OperationShift(7,!0,!0,t+this.register_X);break;case 106:this.OperationShift(2,!0,!1);break;case 102:t=this.FindAddress(2),this.OperationShift(5,!0,!1,t);break;case 118:t=this.FindAddress(3),this.OperationShift(6,!0,!1,t+this.register_X&255);break;case 110:t=this.FindAddress(5),this.OperationShift(6,!0,!1,t);break;case 126:t=this.FindAddress(6),this.OperationShift(7,!0,!1,t+this.register_X);break;case 76:t=this.FindAddress(5),this.OperationJMPOrJSROrBack(3,11,t);break;case 108:t=this.FindAddress(8),this.OperationJMPOrJSROrBack(5,11,t);break;case 32:t=this.FindAddress(5),this.OperationJMPOrJSROrBack(6,12,t);break;case 64:this.OperationJMPOrJSROrBack(6,13);break;case 96:this.OperationJMPOrJSROrBack(6,14);break;case 16:this.OperationBXX(15);break;case 48:this.OperationBXX(16);break;case 80:this.OperationBXX(17);break;case 112:this.OperationBXX(18);break;case 144:this.OperationBXX(19);break;case 176:this.OperationBXX(20);break;case 208:this.OperationBXX(21);break;case 240:this.OperationBXX(22);break;case 0:this.flags[4]=!0,this.DataPush(this.register_PC+1,2),this.DataPush(this.register_P,1),this.flags[2]=!0,this.register_PC=this.FindAddress(11),this.clock=7;break;case 24:this.OperationFlags(0,!1);break;case 88:this.OperationFlags(2,!1);break;case 216:this.OperationFlags(3,!1);break;case 184:this.OperationFlags(6,!1);break;case 56:this.OperationFlags(0,!0);break;case 120:this.OperationFlags(2,!0);break;case 248:this.OperationFlags(3,!0);break;case 234:this.clock=2,this.register_PC++;break;default:throw this.clock=4,Error(e+" "+this.register_PC.toString(16))}},e.prototype.SetOperation=function(e){var t,s=this;switch(e){case 168:t=function(){s.register_Y=s.OperationToRegister(s.register_A)};break;case 170:t=function(){s.register_X=s.OperationToRegister(s.register_A)};break;case 186:t=function(){s.register_X=s.OperationToRegister(s.register_X)};break;case 152:t=function(){s.register_A=s.OperationToRegister(s.register_Y)};break;case 138:t=function(){s.register_A=s.OperationToRegister(s.register_X)};break;case 154:t=function(){s.register_S=s.register_X,s.clock=2,s.register_PC++};break;case 169:t=function(){var e=s.FindAddress(1);s.register_A=s.OperationLD(e,2)};break;case 165:t=function(){var e=s.FindAddress(2);s.register_A=s.OperationLD(e,3)};break;case 181:t=function(){var e=s.FindAddress(3);s.register_A=s.OperationLD(e+s.register_X&255,4)};break;case 173:t=function(){var e=s.FindAddress(5);s.register_A=s.OperationLD(e,4)};break;case 189:t=function(){var e=s.FindAddress(6);s.register_A=s.OperationLD(e+s.register_X,4,(255&e)+s.register_X>255)};break;case 185:t=function(){var e=s.FindAddress(7);s.register_A=s.OperationLD(e+s.register_Y,4,(255&e)+s.register_Y>255)};break;case 161:t=function(){var e=s.FindAddress(9);s.register_A=s.OperationLD(e,6)};break;case 177:t=function(){var e=s.FindAddress(10);s.register_A=s.OperationLD(e+s.register_Y,5,(255&e)+s.register_Y>255)};break;case 162:t=function(){var e=s.FindAddress(1);s.register_X=s.OperationLD(e,2)};break;case 166:t=function(){var e=s.FindAddress(2);s.register_X=s.OperationLD(e,3)};break;case 182:t=function(){var e=s.FindAddress(4);s.register_X=s.OperationLD(e+s.register_Y&255,4)};break;case 174:t=function(){var e=s.FindAddress(5);s.register_X=s.OperationLD(e,4)};break;case 190:t=function(){var e=s.FindAddress(7);s.register_X=s.OperationLD(e+s.register_Y,4,(255&e)+s.register_Y>255)};break;case 160:t=function(){var e=s.FindAddress(1);s.register_Y=s.OperationLD(e,2)};break;case 164:t=function(){var e=s.FindAddress(2);s.register_Y=s.OperationLD(e,3)};break;case 180:t=function(){var e=s.FindAddress(3);s.register_Y=s.OperationLD(e+s.register_X&255,4)};break;case 172:t=function(){var e=s.FindAddress(5);s.register_Y=s.OperationLD(e,4)};break;case 188:t=function(){var e=s.FindAddress(6);s.register_Y=s.OperationLD(e+s.register_X,4,(255&e)+s.register_X>255)};break;case 133:t=function(){var e=s.FindAddress(2);s.OperationST(e,3,s.register_A)};break;case 149:t=function(){var e=s.FindAddress(3);s.OperationST(e+s.register_X&255,4,s.register_A)};break;case 141:t=function(){var e=s.FindAddress(5);s.OperationST(e,4,s.register_A)};break;case 157:t=function(){var e=s.FindAddress(6);s.OperationST(e+s.register_X,5,s.register_A)};break;case 153:t=function(){var e=s.FindAddress(7);s.OperationST(e+s.register_Y,5,s.register_A)};break;case 129:t=function(){var e=s.FindAddress(9);s.OperationST(e,6,s.register_A)};break;case 145:t=function(){var e=s.FindAddress(10);s.OperationST(e+s.register_Y,6,s.register_A)};break;case 134:t=function(){var e=s.FindAddress(2);s.OperationST(e,3,s.register_X)};break;case 150:t=function(){var e=s.FindAddress(4);s.OperationST(e+s.register_Y&255,4,s.register_X)};break;case 142:t=function(){var e=s.FindAddress(5);s.OperationST(e,4,s.register_X)};break;case 132:t=function(){var e=s.FindAddress(2);s.OperationST(e,3,s.register_Y)};break;case 148:t=function(){var e=s.FindAddress(3);s.OperationST(e+s.register_X&255,4,s.register_Y)};break;case 140:t=function(){var e=s.FindAddress(5);s.OperationST(e,4,s.register_Y)};break;case 72:t=function(){s.OperationP(0)};break;case 8:t=function(){s.OperationP(1)};break;case 104:t=function(){s.OperationP(2)};break;case 40:t=function(){s.OperationP(3)};break;case 105:t=function(){var e=s.FindAddress(1);s.OperationADCOrSBC(e,2,4)};break;case 101:t=function(){var e=s.FindAddress(2);s.OperationADCOrSBC(e,3,4)};break;case 117:t=function(){var e=s.FindAddress(3);s.OperationADCOrSBC(e+s.register_X&255,4,4)};break;case 109:t=function(){var e=s.FindAddress(5);s.OperationADCOrSBC(e,4,4)};break;case 125:t=function(){var e=s.FindAddress(6);s.OperationADCOrSBC(e+s.register_X,4,4,(255&e)+s.register_X>255)};break;case 121:t=function(){var e=s.FindAddress(7);s.OperationADCOrSBC(e+s.register_Y,4,4,(255&e)+s.register_Y>255)};break;case 97:t=function(){var e=s.FindAddress(9);s.OperationADCOrSBC(e,6,4)};break;case 113:t=function(){var e=s.FindAddress(10);s.OperationADCOrSBC(e+s.register_Y,5,4,(255&e)+s.register_Y>255)};break;case 233:t=function(){var e=s.FindAddress(1);s.OperationADCOrSBC(e,2,5)};break;case 229:t=function(){var e=s.FindAddress(2);s.OperationADCOrSBC(e,3,5)};break;case 245:t=function(){var e=s.FindAddress(3);s.OperationADCOrSBC(e+s.register_X,4,5)};break;case 237:t=function(){var e=s.FindAddress(5);s.OperationADCOrSBC(e,4,5)};break;case 253:t=function(){var e=s.FindAddress(6);s.OperationADCOrSBC(e+s.register_X,4,5,(255&e)+s.register_X>255)};break;case 249:t=function(){var e=s.FindAddress(7);s.OperationADCOrSBC(e+s.register_Y,4,5,(255&e)+s.register_Y>255)};break;case 225:t=function(){var e=s.FindAddress(9);s.OperationADCOrSBC(e,6,5)};break;case 241:t=function(){var e=s.FindAddress(10);s.OperationADCOrSBC(e+s.register_Y,5,5,(255&e)+s.register_Y>255)};break;case 41:t=function(){var e=s.FindAddress(1);s.OperationANDOrEOROrORA(e,2,6)};break;case 37:t=function(){var e=s.FindAddress(2);s.OperationANDOrEOROrORA(e,3,6)};break;case 53:t=function(){var e=s.FindAddress(3);s.OperationANDOrEOROrORA(e+s.register_X,4,6)};break;case 45:t=function(){var e=s.FindAddress(5);s.OperationANDOrEOROrORA(e,4,6)};break;case 61:t=function(){var e=s.FindAddress(6);s.OperationANDOrEOROrORA(e+s.register_X,4,6,(255&e)+s.register_X>255)};break;case 57:t=function(){var e=s.FindAddress(7);s.OperationANDOrEOROrORA(e+s.register_Y,4,6,(255&e)+s.register_Y>255)};break;case 33:t=function(){var e=s.FindAddress(9);s.OperationANDOrEOROrORA(e,6,6)};break;case 49:t=function(){var e=s.FindAddress(10);s.OperationANDOrEOROrORA(e+s.register_Y,5,6,(255&e)+s.register_Y>255)};break;case 73:t=function(){var e=s.FindAddress(1);s.OperationANDOrEOROrORA(e,2,7)};break;case 69:t=function(){var e=s.FindAddress(2);s.OperationANDOrEOROrORA(e,3,7)};break;case 85:t=function(){var e=s.FindAddress(3);s.OperationANDOrEOROrORA(e+s.register_X,4,7)};break;case 77:t=function(){var e=s.FindAddress(5);s.OperationANDOrEOROrORA(e,4,7)};break;case 93:t=function(){var e=s.FindAddress(6);s.OperationANDOrEOROrORA(e+s.register_X,4,7,(255&e)+s.register_X>255)};break;case 89:t=function(){var e=s.FindAddress(7);s.OperationANDOrEOROrORA(e+s.register_Y,4,7,(255&e)+s.register_Y>255)};break;case 65:t=function(){var e=s.FindAddress(9);s.OperationANDOrEOROrORA(e,6,7)};break;case 81:t=function(){var e=s.FindAddress(10);s.OperationANDOrEOROrORA(e+s.register_Y,5,7,(255&e)+s.register_Y>255)};break;case 9:t=function(){var e=s.FindAddress(1);s.OperationANDOrEOROrORA(e,2,8)};break;case 5:t=function(){var e=s.FindAddress(2);s.OperationANDOrEOROrORA(e,3,8)};break;case 21:t=function(){var e=s.FindAddress(3);s.OperationANDOrEOROrORA(e+s.register_X,4,8)};break;case 13:t=function(){var e=s.FindAddress(5);s.OperationANDOrEOROrORA(e,4,8)};break;case 29:t=function(){var e=s.FindAddress(6);s.OperationANDOrEOROrORA(e+s.register_X,4,8,(255&e)+s.register_X>255)};break;case 25:t=function(){var e=s.FindAddress(7);s.OperationANDOrEOROrORA(e+s.register_Y,4,8,(255&e)+s.register_Y>255)};break;case 1:t=function(){var e=s.FindAddress(9);s.OperationANDOrEOROrORA(e,6,8)};break;case 17:t=function(){var e=s.FindAddress(10);s.OperationANDOrEOROrORA(e+s.register_Y,5,8,(255&e)+s.register_Y>255)};break;case 201:t=function(){var e=s.FindAddress(1);s.OperationCP(s.register_A,e,2)};break;case 197:t=function(){var e=s.FindAddress(2);s.OperationCP(s.register_A,e,3)};break;case 213:t=function(){var e=s.FindAddress(3);s.OperationCP(s.register_A,e+s.register_X&255,2)};break;case 205:t=function(){var e=s.FindAddress(5);s.OperationCP(s.register_A,e,4)};break;case 221:t=function(){var e=s.FindAddress(6);s.OperationCP(s.register_A,e+s.register_X,4,(255&e)+s.register_X>255)};break;case 217:t=function(){var e=s.FindAddress(7);s.OperationCP(s.register_A,e+s.register_Y,4,(255&e)+s.register_Y>255)};break;case 193:t=function(){var e=s.FindAddress(9);s.OperationCP(s.register_A,e,6)};break;case 209:t=function(){var e=s.FindAddress(10);s.OperationCP(s.register_A,e+s.register_Y,5,(255&e)+s.register_Y>255)};break;case 224:t=function(){var e=s.FindAddress(1);s.OperationCP(s.register_X,e,2)};break;case 228:t=function(){var e=s.FindAddress(2);s.OperationCP(s.register_X,e,3)};break;case 236:t=function(){var e=s.FindAddress(5);s.OperationCP(s.register_X,e,4)};break;case 192:t=function(){var e=s.FindAddress(1);s.OperationCP(s.register_Y,e,2)};break;case 196:t=function(){var e=s.FindAddress(2);s.OperationCP(s.register_Y,e,3)};break;case 204:t=function(){var e=s.FindAddress(5);s.OperationCP(s.register_Y,e,4)};break;case 36:t=function(){var e=s.FindAddress(2);s.OperationBIT(e,3)};break;case 44:t=function(){var e=s.FindAddress(5);s.OperationBIT(e,4)};break;case 230:t=function(){var e=s.FindAddress(2);s.OperationINCOrDec(5,1,e,9)};break;case 246:t=function(){var e=s.FindAddress(3);s.OperationINCOrDec(6,1,e+s.register_X&255,9)};break;case 238:t=function(){var e=s.FindAddress(5);s.OperationINCOrDec(6,1,e,9)};break;case 254:t=function(){var e=s.FindAddress(6);s.OperationINCOrDec(7,1,e+s.register_X,9)};break;case 232:t=function(){s.register_X=s.OperationINCOrDec(2,1,s.register_X,10)};break;case 200:t=function(){s.register_Y=s.OperationINCOrDec(2,1,s.register_Y,10)};break;case 198:t=function(){var e=s.FindAddress(2);s.OperationINCOrDec(5,-1,e,9)};break;case 214:t=function(){var e=s.FindAddress(3);s.OperationINCOrDec(6,-1,e+s.register_X&255,9)};break;case 206:t=function(){var e=s.FindAddress(5);s.OperationINCOrDec(6,-1,e,9)};break;case 222:t=function(){var e=s.FindAddress(6);s.OperationINCOrDec(7,-1,e+s.register_X,9)};break;case 202:t=function(){s.register_X=s.OperationINCOrDec(2,-1,s.register_X,10)};break;case 136:t=function(){s.register_Y=s.OperationINCOrDec(2,-1,s.register_Y,10)};break;case 10:t=function(){s.OperationShift(2,!1,!0)};break;case 6:t=function(){var e=s.FindAddress(2);s.OperationShift(5,!1,!0,e)};break;case 22:t=function(){var e=s.FindAddress(3);s.OperationShift(6,!1,!0,e+s.register_X&255)};break;case 14:t=function(){var e=s.FindAddress(5);s.OperationShift(6,!1,!0,e)};break;case 30:t=function(){var e=s.FindAddress(6);s.OperationShift(7,!1,!0,e+s.register_X)};break;case 74:t=function(){s.OperationShift(2,!1,!1)};break;case 70:t=function(){var e=s.FindAddress(2);s.OperationShift(5,!1,!1,e)};break;case 86:t=function(){var e=s.FindAddress(3);s.OperationShift(6,!1,!1,e+s.register_X&255)};break;case 78:t=function(){var e=s.FindAddress(5);s.OperationShift(6,!1,!1,e)};break;case 94:t=function(){var e=s.FindAddress(6);s.OperationShift(7,!1,!1,e+s.register_X)};break;case 42:t=function(){s.OperationShift(2,!0,!0)};break;case 38:t=function(){var e=s.FindAddress(2);s.OperationShift(5,!0,!0,e)};break;case 54:t=function(){var e=s.FindAddress(3);s.OperationShift(6,!0,!0,e+s.register_X&255)};break;case 46:t=function(){var e=s.FindAddress(5);s.OperationShift(6,!0,!0,e)};break;case 62:t=function(){var e=s.FindAddress(6);s.OperationShift(7,!0,!0,e+s.register_X)};break;case 106:t=function(){s.OperationShift(2,!0,!1)};break;case 102:t=function(){var e=s.FindAddress(2);s.OperationShift(5,!0,!1,e)};break;case 118:t=function(){var e=s.FindAddress(3);s.OperationShift(6,!0,!1,e+s.register_X&255)};break;case 110:t=function(){var e=s.FindAddress(5);s.OperationShift(6,!0,!1,e)};break;case 126:t=function(){var e=s.FindAddress(6);s.OperationShift(7,!0,!1,e+s.register_X)};break;case 76:t=function(){var e=s.FindAddress(5);s.OperationJMPOrJSROrBack(3,11,e)};break;case 108:t=function(){var e=s.FindAddress(8);s.OperationJMPOrJSROrBack(5,11,e)};break;case 32:t=function(){var e=s.FindAddress(5);s.OperationJMPOrJSROrBack(6,12,e)};break;case 64:t=function(){s.OperationJMPOrJSROrBack(6,13)};break;case 96:t=function(){s.OperationJMPOrJSROrBack(6,14)};break;case 16:t=function(){s.OperationBXX(15)};break;case 48:t=function(){s.OperationBXX(16)};break;case 80:t=function(){s.OperationBXX(17)};break;case 112:t=function(){s.OperationBXX(18)};break;case 144:t=function(){s.OperationBXX(19)};break;case 176:t=function(){s.OperationBXX(20)};break;case 208:t=function(){s.OperationBXX(21)};break;case 240:t=function(){s.OperationBXX(22)};break;case 0:t=function(){s.flags[4]=!0,s.DataPush(s.register_PC+1,2),s.DataPush(s.register_P,1),s.flags[2]=!0,s.register_PC=s.FindAddress(11),s.clock=7};break;case 24:t=function(){s.OperationFlags(0,!1)};break;case 88:t=function(){s.OperationFlags(2,!1)};break;case 216:t=function(){s.OperationFlags(3,!1)};break;case 184:t=function(){s.OperationFlags(6,!1)};break;case 56:t=function(){s.OperationFlags(0,!0)};break;case 120:t=function(){s.OperationFlags(2,!0)};break;case 248:t=function(){s.OperationFlags(3,!0)};break;case 234:t=function(){s.clock=2,s.register_PC++};break;default:t=function(){throw s.clock=4,Error(e+" "+s.register_PC.toString(16))}}return t},e.prototype.OperationToRegister=function(e){return this.AddClock(2),this.flags[7]=0!=(128&e),this.flags[1]=0==e,this.register_PC++,e},e.prototype.OperationLD=function(e,t,s){void 0===s&&(s=!1),this.AddClock(s?t+1:t);var i=this.GetMemoryData(e,1);return this.flags[7]=0!=(128&i),this.flags[1]=0==i,i},e.prototype.OperationST=function(e,t,s){this.AddClock(t),this.SetMemoryData(e,s)},e.prototype.OperationP=function(e){switch(e){case 0:this.AddClock(3),this.DataPush(this.register_A,1);break;case 1:this.AddClock(3),this.register_P=this.ReadRegisterP(),this.DataPush(this.register_P,1);break;case 2:this.AddClock(4),this.register_A=this.DataPull(1),this.flags[7]=0!=(128&this.register_A),this.flags[1]=0==this.register_A;break;case 3:this.AddClock(4),this.SetRegisterP(this.DataPull(1)),this.flags[4]=!0,this.flags[5]=!0}return this.register_PC++,0},e.prototype.OperationADCOrSBC=function(e,t,s,i){void 0===i&&(i=!1);var r=this.GetMemoryData(e,1),a=this.flags[0]?1:0;switch(this.AddClock(i?t+1:t),s){case 4:this.register_A=this.register_A+a+r,this.flags[0]=this.register_A>255;break;case 5:this.register_A=this.register_A+a-1-r,this.flags[0]=this.register_A>-1}this.flags[6]=(128&r)==(128&this.register_A),this.register_A&=255,this.flags[7]=0!=(128&this.register_A),this.flags[1]=0===this.register_A},e.prototype.OperationANDOrEOROrORA=function(e,t,s,i){void 0===i&&(i=!1),this.AddClock(i?t+1:t);var r=this.GetMemoryData(e,1);switch(s){case 6:this.register_A&=r;break;case 7:this.register_A^=r;break;case 8:this.register_A|=r}this.flags[7]=0!=(128&this.register_A),this.flags[1]=0==this.register_A},e.prototype.OperationCP=function(e,t,s,i){void 0===i&&(i=!1),this.AddClock(i?s+1:s);var r=e-this.GetMemoryData(t,1);this.flags[0]=r>-1,r&=255,this.flags[7]=0!=(128&r),this.flags[1]=0==r},e.prototype.OperationBIT=function(e,t){this.AddClock(t);var s=this.GetMemoryData(e,1),i=this.register_A&s;this.flags[7]=0!=(128&s),this.flags[1]=0==i,this.flags[6]=0!=(64&s)},e.prototype.OperationINCOrDec=function(e,t,s,i){var r,a=0;switch(this.AddClock(e),i){case 9:r=this.GetMemoryData(s,1)+t&255,this.flags[7]=0!=(128&r),this.flags[1]=0===r,this.SetMemoryData(s,r);break;case 10:r=s+t&255,this.flags[7]=0!=(128&r),this.flags[1]=0===r,a=r,this.register_PC++}return a},e.prototype.OperationShift=function(e,t,s,i){void 0===i&&(i=-1),this.AddClock(e);var r=-1==i?this.register_A:this.GetMemoryData(i,1),a=s?1:128;a=this.flags[0]&&t?a:0,s?(this.flags[0]=0!=(128&r),r<<=1,r|=a):(this.flags[0]=0!=(1&r),r>>=1,r|=a),r&=255,this.flags[7]=0!=(128&r),this.flags[1]=0==r,-1==i?(this.register_A=r,this.register_PC++):this.SetMemoryData(i,r)},e.prototype.OperationJMPOrJSROrBack=function(e,t,s){switch(void 0===s&&(s=-1),this.AddClock(e),t){case 11:this.register_PC=s;break;case 12:this.DataPush(this.register_PC-1&65535,2),this.register_PC=s;break;case 13:this.SetRegisterP(this.DataPull(1)),this.register_PC=this.DataPull(2);break;case 14:this.register_PC=this.DataPull(2)+1,14339!=this.register_PC&&14342!=this.register_PC||(this.doNothingMode=!0,this.interruptType=2)}},e.prototype.OperationBXX=function(e){var t=this.FindAddress(2),s=!1;t>127?(s=(255&this.register_PC)-(255^t)<0,t=this.register_PC-(255^t)-1):(s=(255&this.register_PC)+t>255,t=this.register_PC+t);var i=2,r=!0;switch(e){case 15:r=!this.flags[7];break;case 16:r=this.flags[7];break;case 17:r=!this.flags[6];break;case 18:r=this.flags[6];break;case 19:r=!this.flags[0];break;case 20:r=this.flags[0];break;case 21:r=!this.flags[1];break;case 22:r=this.flags[1]}r&&(this.register_PC=t,i++),s&&i++,this.AddClock(i)},e.prototype.OperationFlags=function(e,t){this.AddClock(2),this.flags[e]=t,this.register_PC++},e.prototype.FindAddress=function(e){var t=0;switch(e){case 0:break;case 1:t=this.register_PC+1,this.register_PC+=2;break;case 2:case 3:case 4:t=this.GetMemoryData(this.register_PC+1,1),this.register_PC+=2;break;case 8:t=this.GetMemoryData(this.register_PC+1,2),t=this.GetMemoryData(t,2),this.register_PC+=3;break;case 9:t=this.GetMemoryData(this.register_PC+1,1),t=this.GetMemoryData(t+this.register_X,2),this.register_PC+=2;break;case 10:t=this.GetMemoryData(this.register_PC+1,1),t=this.GetMemoryData(t,2),this.register_PC+=2;break;case 5:case 6:case 7:t=this.GetMemoryData(this.register_PC+1,2),this.register_PC+=3;break;case 11:t=this.GetMemoryData(65534,2);break;case 12:t=this.GetMemoryData(65530,2);break;case 13:t=this.GetMemoryData(65532,2)}return t},e.prototype.GetMemoryData=function(e,t){var s=0;return e<4096?(s=this.memory[e],2==t&&(s|=this.memory[e+1]<<8)):e>=3800&&e<=14591?(s=this.memory[e],2==t&&(s|=this.memory[e+1]<<8)):e>32767&&(s=this.nsf.nsfFile.ReadFileData(e,t)),s},e.prototype.SetMemoryData=function(e,t){if(e<8192)this.memory[65535&e]=t;else if(e<24576)switch(e){case 16384:case 16385:case 16386:case 16387:case 16388:case 16389:case 16390:case 16391:case 16392:case 16394:case 16395:case 16396:case 16397:case 16398:case 16399:case 16400:case 16401:case 16402:case 16403:case 16404:case 16405:this.nsf.apu.SetRegister(e,t);break;case 24568:case 24569:case 24570:case 24571:case 24572:case 24573:case 24574:case 24575:this.nsf.nsfFile.SwitchBank(e,t)}else e>32767&&this.nsf.apu.SetExpansionAudio(e,t)},e.prototype.DataPush=function(e,t){var s=0;2==t&&(this.memory[this.register_S+256]=e>>8&255,s=1),this.memory[this.register_S+256-s]=255&e,this.register_S-=t},e.prototype.DataPull=function(e){var t=this.memory[this.register_S+257];return 2==e&&(t+=this.memory[this.register_S+258]<<8),this.register_S+=e,t},e.prototype.ReadRegisterP=function(){for(var e=0,t=1,s=0;s<8;s++)this.flags[s]&&(e|=t),t<<=1;return e},e.prototype.SetRegisterP=function(e){for(var t=e,s=0;s<8;s++)this.flags[s]=1==(1&t),t>>=1;this.register_P=e},e.prototype.AddClock=function(e){this.clock=e},e.prototype.OneOperation=function(){if(this.doNothingMode)return 2;var e=this.GetMemoryData(this.register_PC,1);return this.nsf.cpu.operations[e](),this.clock},e.prototype.ResetMemory=function(){this.memory=new Uint8Array(32768);for(var e=0;e<this.memory.length;e++)this.memory[e]=0},e}();t.default=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(5),r=s(0),a=function(){function e(e){this.sampleTime=0,this.sequencerMode=!1,this.sequencerStepCount=0,this.sequencerStepMax=4,this.apuClock=0,this.nsf=e,this.mixer=new i.default(e),this.SAMPLE_CPU_CLOCKS=0,this.Reset()}return e.prototype.Reset=function(){this.SAMPLE_CPU_CLOCKS=r.CPU_NTSC/(this.nsf.audioContext.sampleRate/60),this.mixer.Reset()},e.prototype.DoClock=function(e){this.mixer.DoClock(e),this.apuClock+=e,this.apuClock<=r.APU_COUNT_STEP[this.sequencerStepCount]||(this.sequencerStepCount++>=this.sequencerStepMax&&(this.sequencerStepCount=0,this.apuClock=0),1!=this.sequencerStepCount&&3!=this.sequencerStepCount||this.mixer.c2a03Mixer.DoHalfFrame(),(this.sequencerStepCount<3||4==this.sequencerStepCount)&&this.mixer.c2a03Mixer.DoQuarterFrame())},e.prototype.SetRegister=function(e,t){e>=16384&&e<=16405?this.mixer.c2a03Mixer.SetRegister(e,t):16407==e&&(this.sequencerMode=0!=(128&t),this.sequencerStepMax=this.sequencerMode?4:3,this.sequencerStepCount=this.sequencerMode?0:4)},e.prototype.SetExpansionAudio=function(e,t){this.nsf.nsfFile.chip_VRC6&&this.mixer.vrc6Mixer.SetRegister(e,t)},e.prototype.SwitchNESType=function(e){var t=0;switch(e){case 0:t=r.CPU_NTSC;break;case 1:t=r.CPU_PAL;break;case 2:t=r.CPU_Dendy}this.SAMPLE_CPU_CLOCKS=t/(this.nsf.audioContext.sampleRate/60),this.Reset()},e}();t.default=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(6),r=s(9),a=s(15),n=function(){function e(e){this.soundChip=0,this.attenuation=1,this.chipVRC6=!1,this.chipVRC7=!1,this.chipFDS=!1,this.chipMMC5=!1,this.chipNamco163=!1,this.chipSunsoft5B=!1,this.c2a03Mixer=new r.default(e),this.easyBuffer=new a.EasyBuffer,this.Reset()}return e.prototype.Reset=function(){this.chipVRC6=!1,this.chipVRC7=!1,this.chipFDS=!1,this.chipMMC5=!1,this.chipNamco163=!1,this.chipSunsoft5B=!1,this.easyBuffer.Reset(),this.c2a03Mixer.Reset(),this.attenuation=1,0!=(1&this.soundChip)&&(this.chipVRC6=!0,this.attenuation*=.8,this.vrc6Mixer=new i.default),0!=(2&this.soundChip)&&(this.chipVRC7=!0,this.attenuation*=.64),0!=(8&this.soundChip)&&(this.chipMMC5=!0,this.attenuation*=.83),0!=(4&this.soundChip)&&(this.chipFDS=!0,this.attenuation*=.9),0!=(16&this.soundChip)&&(this.chipNamco163=!0,this.attenuation*=.7),0!=(32&this.soundChip)&&(this.chipSunsoft5B=!0,this.attenuation*=.5)},e.prototype.DoClock=function(e){this.c2a03Mixer.DoClock(e),this.chipVRC6&&this.vrc6Mixer.DoClock(e)},e.prototype.GetSample=function(){var e=this.c2a03Mixer.GetSample();return this.chipVRC6&&(e+=this.vrc6Mixer.GetSample()),e},e}();t.default=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(7),r=s(8),a=function(){function e(){this.square1=new i.default,this.square2=new i.default,this.sawtooth=new r.default,this.Reset()}return e.prototype.Reset=function(){this.square1.Reset(),this.square2.Reset(),this.sawtooth.Reset()},e.prototype.DoClock=function(e){this.square1.DoClock(e),this.square2.DoClock(e),this.sawtooth.DoClock(e)},e.prototype.GetSample=function(){return.00852*(this.square1.outputValue+this.square2.outputValue+this.sawtooth.outputValue)},e.prototype.SetRegister=function(e,t){switch(e){case 36864:this.square1.SetDutyAndVolume(t);break;case 36865:this.square1.SetTimerLow(t);break;case 36866:this.square1.SetTimerHighAndEnabled(t);break;case 40960:this.square2.SetDutyAndVolume(t);break;case 40961:this.square2.SetTimerLow(t);break;case 40962:this.square2.SetTimerHighAndEnabled(t);break;case 45056:this.sawtooth.SetStep(t);break;case 45057:this.sawtooth.SetTimerLow(t);break;case 45058:this.sawtooth.SetTimerHighAndEnabled(t)}},e}();t.default=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.dutyLookup=[[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],this.dutyType=0,this.count=0,this.timerMax=0,this.timer=0,this.volume=0,this.enabled=!1,this.cycleCounter=0,this.outputValue=0,this.Reset()}return e.prototype.Reset=function(){this.dutyType=0,this.count=0,this.timer=0,this.volume=0,this.enabled=!1,this.cycleCounter=0,this.outputValue=0},e.prototype.SetEnabled=function(e){this.enabled=e,e||(this.outputValue=0)},e.prototype.SetDutyAndVolume=function(e){this.dutyType=e>>4&7,0!=(128&e)&&(this.dutyType=8),this.volume=15&e},e.prototype.SetTimerLow=function(e){this.timerMax=3840&this.timerMax|e},e.prototype.SetTimerHighAndEnabled=function(e){this.timerMax=255&this.timerMax|(15&e)<<8,this.enabled=0!=(128&e),this.enabled||(this.volume=0)},e.prototype.DoClock=function(e){if(!this.enabled||this.timerMax<1)this.outputValue=0;else{for(this.timer-=e;this.timer<=0;)this.timer+=this.timerMax+1,this.count++,this.count&=31;this.outputValue=this.volume*this.dutyLookup[this.dutyType][15&this.count]}},e}();t.default=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.enabled=!1,this.timer=0,this.timerMax=0,this.outputValue=0,this.stepCount=0,this.step=0,this.lastStep=0,this.Reset()}return e.prototype.Reset=function(){this.stepCount=this.step=0,this.timer=this.timerMax=0,this.outputValue=0},e.prototype.SetTimerLow=function(e){this.timerMax=3840&this.timerMax|e},e.prototype.SetTimerHighAndEnabled=function(e){this.timerMax=255&this.timerMax|(15&e)<<8,this.enabled=0!=(128&e),this.enabled||(this.outputValue=0,this.step=0,this.stepCount=0)},e.prototype.SetStep=function(e){this.step=63&e},e.prototype.DoClock=function(e){if(!this.enabled||this.timerMax<1)this.outputValue=0;else{for(this.timer-=e;this.timer<=0;)this.timer+=this.timerMax+1<<1,0==this.stepCount?this.lastStep=0:this.lastStep=this.lastStep+this.step,this.stepCount++,this.stepCount%=7;this.outputValue=this.lastStep>>3}},e}();t.default=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(10),r=s(11),a=s(12),n=s(13),o=function(){function e(e){this.square1=new i.default(1),this.square2=new i.default(0),this.triangle=new r.default,this.noise=new a.default,this.dpcm=new n.default(e);var t,s=0,o=0;this.square_table=[];for(var h=0;h<32;h++)t=95.52/(8128/h+100),this.square_table[h]=t,t>s&&(s=t);this.tnd_table=[];for(h=0;h<204;h++)t=163.67/(24329/h+100),this.tnd_table[h]=t,t>o&&(o=t);this.dcValue=(s+o)/2}return e.prototype.Reset=function(){this.square1.Reset(),this.square2.Reset(),this.triangle.Reset(),this.noise.Reset(),this.dpcm.Reset()},e.prototype.DoClock=function(e){this.square1.DoClock(e),this.square2.DoClock(e),this.triangle.DoClock(e),this.noise.DoClock(e),this.dpcm.DoClock(e)},e.prototype.DoQuarterFrame=function(){this.square1.DoEnvelopDecayClock(),this.square2.DoEnvelopDecayClock(),this.triangle.DoLinerClock(),this.noise.DoEnvelopDecayClock()},e.prototype.DoHalfFrame=function(){this.square1.DoSweepClock(),this.square2.DoSweepClock(),this.square1.DoFrameClock(),this.square2.DoFrameClock(),this.triangle.DoFrameClock(),this.noise.DoFrameClock()},e.prototype.GetSample=function(){var e=.00752*(this.square1.outputValue+this.square2.outputValue);return e+=.00851*this.triangle.outputValue+.00494*this.noise.outputValue+.00335*this.dpcm.outputValue},e.prototype.SetRegister=function(e,t){switch(e){case 16384:this.square1.SetDutyAndVolume(t);break;case 16385:this.square1.SetSweep(t);break;case 16386:this.square1.SetTimerLow(t);break;case 16387:this.square1.SetTimerHigh(t);break;case 16388:this.square2.SetDutyAndVolume(t);break;case 16389:this.square2.SetSweep(t);break;case 16390:this.square2.SetTimerLow(t);break;case 16391:this.square2.SetTimerHigh(t);break;case 16392:this.triangle.SetLinearCounter(t);break;case 16393:break;case 16394:this.triangle.SetTimerLow(t);break;case 16395:this.triangle.SetTimerHigh(t);break;case 16396:this.noise.SetVolumeOrEnvelope(t);break;case 16398:this.noise.SetTimerAndMode(t);break;case 16399:this.noise.SetFrameCounter(t);break;case 16400:this.dpcm.SetFlagsAndRate(t);break;case 16401:this.dpcm.SetDirectLoad(t);break;case 16402:this.dpcm.SetSampleAddress(t);break;case 16403:this.dpcm.SetSampleLength(t);break;case 16405:this.square1.SetEnabled(0!=(1&t)),this.square2.SetEnabled(0!=(2&t)),this.triangle.SetEnabled(0!=(4&t)),this.noise.SetEnabled(0!=(8&t)),this.dpcm.SetEnabled(0!=(16&t))}},e}();t.default=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(0),r=function(){function e(e){this.dutyLookup2=[[0,1,0,0,0,0,0,0],[0,1,1,0,0,0,0,0],[0,1,1,1,1,0,0,0],[1,0,0,1,1,1,1,1]],this.dutyLookup=[[0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0],[0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0],[1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1]],this.dutyType=0,this.dutyIndex=0,this.timerMax=0,this.timer=0,this.volume=0,this.sweepEnabled=!1,this.sweepDirection=!1,this.sweepUpdateRate=0,this.sweepUpdateCount=0,this.sweepRightShiftAmount=0,this.sweepChange=0,this.envelopeEnabled=!1,this.envelopeLoopingEnable=!1,this.envelopeRateMax=0,this.envelopeRateCount=0,this.envelopeReset=!1,this.envelopeVolumn=0,this.frameCounter=0,this.frameCounterEnable=!1,this.enabled=!1,this.outputValue=0,this.sweepChange=e,this.Reset()}return e.prototype.Reset=function(){this.dutyType=0,this.dutyIndex=0,this.timer=0,this.volume=0,this.envelopeEnabled=!1,this.envelopeLoopingEnable=!1,this.enabled=!0,this.outputValue=0},e.prototype.SetEnabled=function(e){this.enabled=e,e||(this.frameCounter=0),this.UpdateSampleValue()},e.prototype.SetDutyAndVolume=function(e){this.dutyType=(192&e)>>6,this.frameCounterEnable=0==(32&e),this.envelopeLoopingEnable=0==(16&e),this.envelopeEnabled=0==(16&e),this.envelopeRateMax=15&e},e.prototype.SetSweep=function(e){this.sweepEnabled=0!=(128&e),this.sweepUpdateRate=e>>4&7,this.sweepDirection=0!=(8&e),this.sweepRightShiftAmount=7&e},e.prototype.SetTimerLow=function(e){this.timerMax=1792&this.timerMax|255&e},e.prototype.SetTimerHigh=function(e){this.envelopeReset=!0,this.timerMax=255&this.timerMax|(7&e)<<8,this.enabled&&(this.frameCounter=i.FrameCountLength[e>>3])},e.prototype.UpdateSampleValue=function(){this.enabled&&this.frameCounter>0&&this.timerMax>7?!this.sweepDirection&&this.timer+(this.timer>>this.sweepRightShiftAmount)>4095?this.outputValue=0:this.outputValue=this.volume*this.dutyLookup[this.dutyType][this.dutyIndex]:this.outputValue=0},e.prototype.DoClock=function(e){if(!this.enabled||this.timerMax<8)this.outputValue=0;else{for(this.timer-=e;this.timer<=0;)this.timer+=this.timerMax+1,this.dutyIndex++,this.dutyIndex&=15;this.UpdateSampleValue()}},e.prototype.DoFrameClock=function(){this.frameCounterEnable&&this.frameCounter>0&&0==--this.frameCounter&&this.UpdateSampleValue()},e.prototype.DoEnvelopDecayClock=function(){this.envelopeReset?(this.envelopeReset=!1,this.envelopeRateCount=this.envelopeRateMax+1,this.envelopeVolumn=15):--this.envelopeRateCount<=0&&(this.envelopeRateCount=this.envelopeRateMax+1,this.envelopeVolumn>0?this.envelopeVolumn--:this.envelopeVolumn=this.envelopeLoopingEnable?15:0),this.envelopeEnabled?this.volume=this.envelopeVolumn:this.volume=this.envelopeRateMax,this.UpdateSampleValue()},e.prototype.DoSweepClock=function(){--this.sweepUpdateCount<=0&&(this.sweepUpdateCount=this.sweepUpdateRate+1,this.sweepEnabled&&this.sweepRightShiftAmount>0&&this.timer>7&&(this.sweepDirection?this.timerMax=this.timerMax-(this.timerMax>>this.sweepRightShiftAmount)-this.sweepChange:(this.timerMax+=this.timerMax>>this.sweepRightShiftAmount,this.timerMax>4095&&(this.timerMax=4095))))},e}();t.default=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(0),r=function(){function e(){this.steps=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],this.enabled=!1,this.outputValue=0,this.timer=0,this.timerMax=0,this.frameCounter=0,this.stepIndex=0,this.linerCounterFlag=!1,this.linerCounterReloadFlag=!1,this.linerCounter=0,this.linerCounterMax=0,this.Reset()}return e.prototype.Reset=function(){this.timer=0,this.timerMax=0,this.frameCounter=0,this.stepIndex=0,this.linerCounterFlag=!1,this.linerCounter=0,this.enabled=!0},e.prototype.SetEnabled=function(e){this.enabled=e,e||(this.outputValue=0)},e.prototype.SetTimerLow=function(e){this.timerMax=1792&this.timerMax|255&e},e.prototype.SetTimerHigh=function(e){this.linerCounterReloadFlag=!0,this.timerMax=255&this.timerMax|(7&e)<<8,this.enabled&&(this.frameCounter=i.FrameCountLength[e>>3])},e.prototype.SetLinearCounter=function(e){this.linerCounterFlag=0==(128&e),this.linerCounterMax=127&e,this.linerCounterReloadFlag=!0},e.prototype.DoClock=function(e){if(!this.enabled||this.timerMax<1)return this.outputValue=0,void(this.stepIndex=0);for(this.timer-=e;this.timer<=0;)this.timer+=this.timerMax+1,this.linerCounter>0&&this.frameCounter>0&&(this.stepIndex++,this.stepIndex&=31);this.outputValue=this.steps[this.stepIndex]},e.prototype.DoFrameClock=function(){!this.linerCounterFlag&&this.frameCounter>0&&this.frameCounter--},e.prototype.DoLinerClock=function(){this.linerCounterReloadFlag&&(this.linerCounter=this.linerCounterMax,this.linerCounterReloadFlag=!1),this.linerCounterFlag&&this.linerCounter>0&&this.linerCounter--},e}();t.default=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(0),r=function(){function e(){this.noiseWaveLengthLookup_NTSC=[4,8,16,32,64,96,128,160,202,254,380,508,762,1016,2034,4068],this.noiseWaveLengthLookup_PAL=[4,8,14,30,60,88,118,148,188,236,354,472,708,944,1890,3778],this.lookUp=this.noiseWaveLengthLookup_NTSC,this.shiftReg=1,this.enabled=!0,this.timer=0,this.timerMax=0,this.randomMode=!1,this.frameCounterEnable=!1,this.frameCounter=0,this.outBit=0,this.volume=0,this.outputValue=0,this.envelopeEnabled=!1,this.envelopeLoopingEnable=!1,this.envelopeVolumn=0,this.envelopeRateMax=0,this.envelopeRateCount=0,this.envelopeReset=!1,this.temp=0,this.Reset()}return e.prototype.Reset=function(){this.shiftReg=1,this.outBit=0,this.volume=0,this.outputValue=0,this.frameCounter=0,this.frameCounterEnable=!1,this.envelopeEnabled=!1,this.timer=0,this.timerMax=0},e.prototype.SetEnabled=function(e){this.enabled=e,e||(this.frameCounter=0),this.UpdateSampleValue()},e.prototype.SetVolumeOrEnvelope=function(e){this.frameCounterEnable=0==(32&e),this.envelopeLoopingEnable=0==(16&e),this.envelopeEnabled=0==(16&e),this.envelopeRateMax=15&e,this.volume=this.envelopeRateMax},e.prototype.SetTimerAndMode=function(e){this.timerMax=this.lookUp[15&e],this.randomMode=0==(8&e)},e.prototype.SetFrameCounter=function(e){this.frameCounter=i.FrameCountLength[e>>3],this.envelopeReset=!0},e.prototype.DoClock=function(e){if(!this.enabled||this.timerMax<1||this.frameCounter<1)this.outputValue=0;else{for(this.timer-=e;this.timer<=0;)this.timer+=this.timerMax,this.shiftReg<<=1,this.temp=16384&(this.shiftReg<<(this.randomMode?1:3)^this.shiftReg),0!=this.temp?(this.shiftReg|=1,this.outBit=0):this.outBit=1;this.UpdateSampleValue()}},e.prototype.DoEnvelopDecayClock=function(){this.envelopeReset&&(this.envelopeReset=!1,this.envelopeRateCount=this.envelopeRateMax,this.envelopeVolumn=15),--this.envelopeRateCount<=0&&(this.envelopeRateCount+=this.envelopeRateMax+1,this.envelopeVolumn>0?this.envelopeVolumn--:this.envelopeVolumn+=this.envelopeLoopingEnable?15:0),this.envelopeEnabled?this.volume=this.envelopeVolumn:this.volume=this.envelopeRateMax,this.UpdateSampleValue()},e.prototype.DoFrameClock=function(){this.frameCounterEnable&&this.frameCounter>0&&0==--this.frameCounter&&this.UpdateSampleValue()},e.prototype.UpdateSampleValue=function(){this.enabled&&this.frameCounter>0?this.outputValue=this.outBit*this.volume:this.outputValue=0},e.prototype.SwitchType=function(e){switch(e){case 0:case 2:this.lookUp=this.noiseWaveLengthLookup_NTSC;break;case 1:this.lookUp=this.noiseWaveLengthLookup_PAL}},e}();t.default=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.enabled=!1,this.rateIndex_NTSC=[428,380,340,320,286,254,226,214,190,160,142,128,106,84,72,54],this.rateIndex_PAL=[398,354,316,298,276,236,210,198,176,148,132,118,98,78,66,50],this.IRQEnables=!1,this.loopFlag=!1,this.sampleAddress=0,this.nowAddress=0,this.sampleLength=0,this.nowLength=0,this.timer=0,this.timerMax=0,this.deltaCounter=0,this.dacLsb=0,this.dataCount=0,this.data=0,this.outputValue=0,this.nsf=e,this.Reset()}return e.prototype.Reset=function(){this.data=0,this.dataCount=8,this.deltaCounter=0,this.IRQEnables=!1,this.loopFlag=!1,this.timer=this.timerMax=0},e.prototype.SetEnabled=function(e){this.enabled=e,e?(this.dataCount=1,this.GetSample()):this.outputValue=0},e.prototype.SetFlagsAndRate=function(e){this.IRQEnables=0!=(128&e),this.loopFlag=0!=(64&e),this.timerMax=this.rateIndex_NTSC[15&e]},e.prototype.SetDirectLoad=function(e){this.deltaCounter=e>>1&63,this.dacLsb=1&e,this.outputValue=127&e},e.prototype.SetSampleAddress=function(e){this.sampleAddress=49152+(e<<6),this.nowAddress=this.sampleAddress},e.prototype.SetSampleLength=function(e){this.sampleLength=1+(e<<4),this.nowLength=this.sampleLength},e.prototype.DoClock=function(e){if(!this.enabled||this.timerMax<1)this.outputValue=0;else{for(this.timer-=e;this.timer<=0;)this.timer+=this.timerMax,this.deltaCounter+=0==(1&this.data)?-1:1,this.deltaCounter<0?this.deltaCounter=0:this.deltaCounter>63&&(this.deltaCounter=63),this.data>>=1,this.GetSample();this.outputValue=(this.deltaCounter<<1)+this.dacLsb}},e.prototype.GetSample=function(){--this.dataCount<=0&&(this.dataCount=8,0==this.nowLength&&this.loopFlag?(this.nowAddress=this.sampleAddress,this.nowLength=this.sampleLength):this.nowLength>0&&(this.data=this.nsf.nsfFile.ReadFileData(this.nowAddress,1),this.nsf.cpu.AddClock(2),this.nowLength--,++this.nowAddress>65535&&(this.nowAddress=32768)))},e}();t.default=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.songsCount=0,this.startSong=0,this.name="",this.artist="",this.copyright="",this.fileStatues=0,this.banks=[],this.bankIndex=[0,0,0,0,0,0,0,0],this.chip_VRC6=!1,this.chip_VRC7=!1,this.chip_FDS=!1,this.chip_MMC5=!1,this.chip_Namco163=!1,this.chip_Sunsoft5B=!1,this.loadAddress=0,this.initAddress=0,this.playAddress=0,this.nsf=e}return e.prototype.LoadFile=function(e){var t=new Uint8Array(e);if(78!=t[0]||69!=t[1]||83!=t[2]||77!=t[3]||26!=t[4])throw Error("NSF");this.nsf.apu.mixer.soundChip=t[123],this.chip_VRC6=0!=(1&t[123]),this.chip_VRC7=0!=(2&t[123]),this.chip_FDS=0!=(4&t[123]),this.chip_MMC5=0!=(8&t[123]),this.chip_Namco163=0!=(16&t[123]),this.chip_Sunsoft5B=0!=(32&t[123]),this.songsCount=t[6],this.startSong=t[7],this.loadAddress=t[8]|t[9]<<8,this.initAddress=t[10]|t[11]<<8,this.playAddress=t[12]|t[13]<<8;for(var s=t.slice(128),i=Math.floor((this.loadAddress-32768)/4096),r=4096-(4095&this.loadAddress),a=0,n=0;a<s.length;a+=4096,n++)n<i?(this.banks[n]=new Uint8Array(4096),a-=4096):(this.banks[n]=new Uint8Array(4096),a+r<=s.length?(this.banks[n].set(s.slice(a,a+r),4096-r),a-=4096-r,r=4096):this.banks[n].set(s.slice(a)));for(a=0;a<8;a++){var o=t[112+a];0==o&&(o=a),this.SwitchBank(24568+a,o)}this.nsf.play=!1},e.prototype.SwitchBank=function(e,t){e>=24568&&e<=24575&&(this.bankIndex[7&e]=t)},e.prototype.ReadFileData=function(e,t){var s=(28672&e)>>12,i=this.bankIndex[s],r=this.banks[i][4095&e];return 2==t&&(r|=this.ReadFileData(e+1,1)<<8),r},e}();t.default=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.lastBuffer=0,this.pre=0}return e.prototype.Reset=function(){this.lastBuffer=0},e.prototype.SetBuffer=function(e){if(0==this.pre)return this.lastBuffer=e,this.pre=1,e;var t=Math.abs(e)-Math.abs(this.lastBuffer);return 0==t?(this.lastBuffer=e,e):1==this.pre?t>0?(this.pre=-1,-t):t:t>0?(this.pre=1,t):-t},e}();t.EasyBuffer=i}]);